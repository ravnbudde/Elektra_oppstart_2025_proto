function mqtt_setup(car_id, broker, port, bn, pw)
    % Oppsett for systemet med MQTT-integrasjon
    % kall med mqtt_setup(14, "192.168.1.3", "1883", "BIAISbroker",  "shinyteapot294")
    if nargin < 2
        error("Du mÃ¥ minst spesifisere car_id og broker ('localhost', IP eller URL).");
    end

    % ðŸŒŸ 1. Set opp identitet og topic
    fprintf("ðŸš— Setter opp system med car_id = %d\n", car_id);
    assignin("base", "car_id", uint8(car_id));

    basetopic = sprintf("zumo_car/%d", car_id);
    assignin("base", "basetopic", basetopic);
    fprintf("ðŸ”— base topic satt til: %s\n", basetopic);

    % 2. Legg relevante mapper til path
    projectRoot = fileparts(mfilename('fullpath'));
    addpath(genpath(projectRoot));
    fprintf("ðŸ“ Alle undermapper i %s lagt til.\n", projectRoot);

    % 3. Init SensorData og referanse
    sensorData = SensorData();
    sensor_ref("set", sensorData);
    disp(sensor_ref("get"));

    % ðŸ”Œ 4. MQTT-klient
    % Legg til "tcp://" om ingen protokoll er spesifisert
    if ~contains(broker, "://")
        broker = "tcp://" + broker;
    end

    if nargin < 4
        client = mqtt_initClient(broker, str2double(port));
    else
        client = mqtt_initClient(broker, str2double(port), ...
            "Username", bn, "Password", pw);
    end
    assignin("base", "mqttClient", client);
    pause(2);  % Kort pause fÃ¸r abonnement

    % 5. Abonner pÃ¥ relevante sensor-topicar
    topics = [
        "accel", "accel/x", "accel/y", "accel/z", ...
        "gyro", "gyro/z", ...
        "line", ...
        "encoder/left", "encoder/right"
    ];
    mqtt_subscribe(basetopic, topics);

end
